{"version":3,"file":"src_app_pages_client_profile-client_profile-client_module_ts.js","mappings":"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","sources":["./src/app/pages/client/profile-client/profile-client-routing.module.ts","./src/app/pages/client/profile-client/profile-client.module.ts","./src/app/pages/client/profile-client/profile-client.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { ProfileClientPage } from './profile-client.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ProfileClientPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class ProfileClientPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ProfileClientPageRoutingModule } from './profile-client-routing.module';\n\nimport { ProfileClientPage } from './profile-client.page';\nimport { SharedModule } from 'src/app/shared/shared.module';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    SharedModule,\n    ReactiveFormsModule,\n    ProfileClientPageRoutingModule\n  ],\n  declarations: [ProfileClientPage]\n})\nexport class ProfileClientPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { User, UserFormData } from 'src/app/core/models/user';\nimport { AlertsService } from 'src/app/shared/utilities/alerts';\nimport { VerificationFuncService } from 'src/app/shared/utilities/verificationFunc';\nimport { attachmentOptions, UserPhoto } from 'src/app/core/models/images';\nimport { AttachmentsService } from 'src/app/shared/utilities/attachments.service';\nimport { ImageUploaderService } from 'src/app/core/services/image-uploader.service';\nimport { IonRouterOutlet, ModalController } from '@ionic/angular';\nimport { FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { FireAuthService } from 'src/app/core/services/modules/fire-auth.service';\n\n@Component({\n  selector: 'app-profile-client',\n  templateUrl: './profile-client.page.html',\n  styleUrls: ['./profile-client.page.scss'],\n})\nexport class ProfileClientPage implements OnInit {\n  loading = false;\n  edit = false;\n  defaultUser = '../../../../assets/profile/ProfileBlank.png';\n  newImage;\n  progress=0;\n\n  user: User;\n  userData: UserFormData;\n\n  registerForm: FormGroup;\n  validationMessages  = {\n    name:[ {type: 'required', message: ' Escribe tu nombre'},],\n    lastName:[ {type: 'required', message: ' Escribe tu apellido'},],\n    birthday:[ {type: 'required', message: ' Ingresa tu fecha de nacimiento'},]\n  };\n\n  constructor(\n    private router: Router,\n    private alerts: AlertsService,\n    private upload: ImageUploaderService,\n    private images: AttachmentsService,\n    private modal: ModalController,\n    private routerOutlet: IonRouterOutlet,\n    private formBuilder: FormBuilder,\n    private auth: FireAuthService,\n    private verification: VerificationFuncService,\n  ) { }\n\n  ngOnInit() {\n    this.registerForm = this.formBuilder.group({\n      name:[null, { validators: [Validators.required, Validators.minLength(2)] }],\n      lastName:[null, { validators: [Validators.required, Validators.minLength(3)] }],\n      birthday:[null, { validators: [Validators.required] }]\n    });\n    this.checkUser().then(ok => {\n      this.images.loadSaved().then((attachment: any) => {\n        if (attachment.length && attachment[0].deploy){\n          this.changeProfileImage(attachment[0]);\n        }\n      });\n    });\n  }\n\n  EnterSubmit(evt, form){\n    this.verification.EnterSubmit(evt,form,this.loading).then(answer => {\n      if(answer){ console.log('Enter') }\n    })\n  }\n\n  checkUser() {\n    return new Promise((resolve, reject) => {\n      try {\n        this.loading = true;\n        this.auth.getUser().then((user: any) =>{\n          this.user = user.user;\n          this.userData = user.data;\n          this.loading = false;\n          resolve('done')\n        });\n      } catch (error) {\n        console.log(error);\n        this.loading = false;\n        reject(error);\n      }\n    })\n  }\n\n  editForm(){\n    if(!this.edit){\n      this.edit = !this.edit;\n      this.registerForm = this.formBuilder.group({\n        name:[this.userData.name, { validators: [Validators.required, Validators.minLength(2)] }],\n        lastName:[this.userData.lastName, { validators: [Validators.required, Validators.minLength(3)] }],\n        birthday:[this.userData.birthDate, { validators: [Validators.required] }]\n      });\n    } else {\n      const newValues = this.registerForm.value;\n      const nameCheck = this.userData.name !== newValues.name;\n      const lastNameCheck = this.userData.lastName !== newValues.lastName;\n      const birthDateCheck = this.userData.birthDate !== newValues.birthday;\n      if(nameCheck || lastNameCheck || birthDateCheck) {\n        this.loading = true;\n        const data = {\n          ...this.userData,\n          name: newValues.name,\n          lastName: newValues.lastName,\n          birthDate: newValues.birthday\n        }\n        this.auth.uploadUserForm(this.user.uid, data)\n        .then(ok => { \n          this.edit = !this.edit;\n          this.alerts.showAlert('PERFIL','Tus datos han sido actualizados','OK');\n          this.checkUser();\n          this.loading = false;\n        })\n      } else{\n        this.edit = !this.edit;\n      }\n    }\n  }\n\n  // IMAGE SYSTEM\n  addPhoto() {\n    const options: attachmentOptions = {\n      currentRoute: 'manager/profile',\n      height:null, width:null, pdf: false\n    }\n    this.images.presentImageOptions(options).then(imageObj => {\n      if (imageObj[0] !== undefined){\n        this.changeProfileImage(imageObj[0]);\n      }\n    });\n  }\n\n  changeProfileImage(image: UserPhoto){\n    this.loading = true;\n    this.newImage = image;\n    const imageName = Date().toString()+'_'+this.user.uid;\n    this.upload.uploadFile('profile',imageName, image.file,\n    (progress)=>{ this.progress = progress })\n    .then((data:any) => {\n      this.auth.updateUser('cliente', data.url).then(done => {\n        this.alerts.showAlert('PERFIL','Tus imagen de perfil ha sido actualizada','OK');\n        this.upload.deletePicture();\n        this.newImage = null;\n        this.checkUser();\n        this.loading = false;\n      })\n    })\n  }\n\n  upgradeProfile(){\n    this.loading = true;\n    this.auth.upgradeUser('administrador').then((done: any) => {\n      this.alerts.showAlert('PERFIL',done,'OK').then(() => {\n        this.router.navigateByUrl('general/login');\n      });\n      this.checkUser();\n      this.loading = false;\n    })\n  }\n\n  async doRefresh(refresh?){\n    await this.checkUser().then(done => {\n      console.log('done');\n      if (refresh){ refresh.target.complete(); }\n    }).catch(error => {\n      console.log(error);\n      if (refresh){ refresh.target.complete(); }\n    })\n  }\n}\n"],"names":["Component","Router","AlertsService","VerificationFuncService","AttachmentsService","ImageUploaderService","IonRouterOutlet","ModalController","FormBuilder","Validators","FireAuthService","ProfileClientPage","constructor","router","alerts","upload","images","modal","routerOutlet","formBuilder","auth","verification","name","type","message","lastName","birthday","ngOnInit","registerForm","group","validators","required","minLength","checkUser","then","ok","loadSaved","attachment","length","deploy","changeProfileImage","EnterSubmit","evt","form","loading","answer","console","log","Promise","resolve","reject","getUser","user","userData","data","error","editForm","edit","birthDate","newValues","value","nameCheck","lastNameCheck","birthDateCheck","uploadUserForm","uid","showAlert","addPhoto","options","currentRoute","height","width","pdf","presentImageOptions","imageObj","undefined","image","newImage","imageName","Date","toString","uploadFile","file","progress","updateUser","url","done","deletePicture","upgradeProfile","upgradeUser","navigateByUrl","doRefresh","refresh","target","complete","catch","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}