<ion-content>
  <ion-row *ngIf="!loading">
    <ion-col>
      <div class="ion-float-end">
        <ion-button (click)="prevMonth()" size="small">{{'< Anterior '}}</ion-button>
      </div>
    </ion-col>
    <ion-col class="ion-text-center">
      <ion-label class="ion-text-uppercase iom-margin-top">{{selectedMonth | timeFormat: 'MonthDisplay'}}</ion-label>
    </ion-col>
    <ion-col class="ion-float-start">
      <div>
        <ion-button (click)="nextMonth()" size="small">{{' Siguiente >'}}</ion-button>
      </div>
    </ion-col>
  </ion-row>
  <app-loading-view *ngIf="loading"></app-loading-view>

<app-not-data-yet-message 
  *ngIf="billsList.length == 0 && !loading"
  text="No tienes recibos aún" icon="alert-circle-outline"
></app-not-data-yet-message>

<ion-list *ngIf="!loading && billsList.length > 0">
  <ion-row class="headerUserList">
    <ion-col size="4" class="ion-text-center">Residente</ion-col>
    <ion-col size="1" class="ion-text-center">Items</ion-col>
    <ion-col size="3" class="ion-text-center">Total</ion-col>
    <ion-col size="4" class="ion-text-center">Status</ion-col>
  </ion-row>
  <app-receipt-item *ngFor="let receipt of billsList" [receipt]="receipt" (click)="newReceiptModal(receipt)"></app-receipt-item>
</ion-list>
  <ion-fab vertical="bottom" horizontal="center" slot="fixed">
    <ion-fab-button color="secondary" id="open-modal" >
      <ion-icon size="large" name="receipt-outline"></ion-icon>
    </ion-fab-button>
  </ion-fab>

  <ion-modal #modal trigger="open-modal" [initialBreakpoint]="0.5" [breakpoints]="[0, 0.5]">
    <ng-template>
      <ion-content class=" ion-padding">
        <ion-list>
          <ion-list-header>
            <ion-label>Generador de Recibos</ion-label>
          </ion-list-header>
          <p *ngIf="receiptProgress > 0">Generando Recibos...</p>
          <ion-progress-bar *ngIf="receiptProgress > 0" [value]="receiptProgress"></ion-progress-bar>
          <p *ngIf="receiptProgress === 0">Se genera una lista de recibos para todos los residentes existentes. Seleccione el mes y año de los recibos que desea crear:</p>
          <ion-item *ngIf="receiptProgress === 0">
            <ion-datetime #datetime style="margin: 0 auto;" [value]="receiptDate" (ionChange)="changeReceiptDate(datetime.value)" presentation="month-year"></ion-datetime>
          </ion-item>
          <ion-row>
            <ion-col>
              <ion-button color="danger" expand="block" (click)="modal.dismiss()" [disabled]="receiptProgress > 0">Cancelar</ion-button>
            </ion-col>
            <ion-col>
              <ion-button expand="block" (click)="createListReceipt()" [disabled]="receiptProgress > 0">Crear Recibos</ion-button>
            </ion-col>
          </ion-row>
        </ion-list>
      </ion-content>
    </ng-template>
  </ion-modal>
</ion-content>